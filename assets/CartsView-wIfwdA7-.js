import{S as m}from"./sweetalert2.all-2uCbP9v4.js";import{_ as V,r as v,o as r,c as d,a as t,F as k,f as x,t as g,g as y,d as T,b as n,w as C,n as L,e as D,h as E,i as _}from"./index-IZRPLD-R.js";var S={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"vuejs2024",BASE_URL:"/vite_week6_20240223/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:c,VITE_PATH:u}=S,U={data(){return{carts:[],status:{addToCartLoading:"",delCartLoading:""},form:{user:{name:"",email:"",tel:"",address:""},message:""}}},methods:{addToCart(a,s=1){const p={product_id:a.id,qty:s};this.status.addToCartLoading=a.id,this.$http.post(`${c}/api/${u}/cart`,{data:p}).then(()=>{this.status.addToCartLoading="",this.$refs.pModal.close(),this.getCarts()}).catch(f=>{alert("未加入購物車",f.response)})},getCarts(){this.$http(`${c}/api/${u}/cart`).then(a=>{this.carts=a.data.data}).catch(a=>{alert("未取得購物車資料",a.response)})},changeQty(a,s=1){const p={product_id:a.product_id,qty:s};this.$http.put(`${c}/api/${u}/cart/${a.id}`,{data:p}).then(()=>{this.getCarts()}).catch(f=>{alert("未變更購物車數量",f.response)})},delCart(a){this.$http.delete(`${c}/api/${u}/cart/${a}`).then(()=>{m.fire({icon:"success",title:"項目已刪除囉",showConfirmButton:!0}),this.getCarts()}).catch(s=>{alert("未刪除單一購物車品項",s.response)})},delCarts(){this.status.delCartLoading=this.carts,this.$http.delete(`${c}/api/${u}/carts`).then(()=>{this.status.delCartLoading="",m.fire({icon:"success",title:"全部刪除囉",showConfirmButton:!1,timer:1500}),this.getCarts()}).catch(()=>{this.status.delCartLoading="",m.fire({icon:"warning",title:"購物車沒品項唷",showConfirmButton:!0})})},isPhone(a){return/^(09)[0-9]{8}$/.test(a)?!0:"電話號碼需09開頭唷"},resetData(){this.$refs.form.resetForm()},onSubmit(){const a=this.form;this.$http.post(`${c}/api/${u}/order`,{data:a}).then(()=>{m.fire({icon:"success",title:"已建立訂單囉",showConfirmButton:!1,timer:1500}),this.$refs.form.resetForm(),this.getCarts()}).catch(()=>{m.fire({icon:"warning",title:"購物車沒品項唷",showConfirmButton:!0})})}},mounted(){this.getCarts()}},q={class:"py-5"},B={class:"card py-5 px-3"},N={class:"card-body"},F={class:"row justify-content-center"},$={class:"col-md-10"},A={class:"table align-middle text-center"},M=t("thead",null,[t("tr",null,[t("th",{width:"150"},"商品圖"),t("th",{width:"200"},"品名"),t("th",null,"數量"),t("th",{width:"150"},"單價")])],-1),P={class:"d-flex flex-nowrap justify-content-center"},R=["onClick"],j=t("i",{class:"bi bi-dash-lg"},null,-1),z=[j],Q=["onClick"],H=t("i",{class:"bi bi-trash-fill"},null,-1),O=[H],G=["onUpdate:modelValue"],J=["onClick"],K=t("i",{class:"bi bi-plus-lg"},null,-1),W=[K],X={class:"text-end"},Y={class:"text-end fw-bold"},Z=t("td",{colspan:"3"},"總價",-1),I={colspan:"4"},tt={key:0,class:"text-success text-end fw-bold"},et=t("td",{colspan:"3"},"優惠價",-1),st={colspan:"4"},ot={key:0,class:"spinner-border spinner-border-sm","aria-hidden":"true"},at=t("div",{class:"my-5"},[t("hr")],-1),lt={class:"mx-auto",style:{width:"500px"}},nt=t("h3",{class:"fw-bold text-center"}," 請填寫表單 ",-1),it={class:"mb-3"},rt=t("label",{for:"mail",class:"form-label fw-bold"}," 信箱 ",-1),dt={class:"mb-3"},ct=t("label",{for:"name",class:"form-label fw-bold"}," 姓名 ",-1),ut={class:"mb-3"},ht=t("label",{for:"tel",class:"form-label fw-bold"}," 電話 ",-1),mt={class:"mb-3"},_t=t("label",{for:"address",class:"form-label fw-bold"}," 地址 ",-1),pt=t("option",{value:"",selected:"",disabled:""},"請選擇地區",-1),ft=t("option",{value:"台北市"},"台北市",-1),bt=t("option",{value:"新北市"},"新北市",-1),gt=t("option",{value:"桃園市"},"桃園市",-1),vt=t("option",{value:"新竹市"},"新竹市",-1),yt=t("option",{value:"台中市"},"台中市",-1),Ct={class:"mb-3"},wt=t("label",{for:"message",class:"form-label fw-bold"}," 留言 ",-1),Vt={class:"mb-3"},kt={class:"d-flex gap-2 justify-content-end"},xt=t("button",{class:"btn btn-primary w-25",type:"submit"},"送出",-1);function Tt(a,s,p,f,o,i){const h=v("VField"),b=v("error-message"),w=v("VForm");return r(),d("div",q,[t("div",B,[t("div",N,[t("div",F,[t("div",$,[t("table",A,[M,t("tbody",null,[(r(!0),d(k,null,x(o.carts.carts,e=>(r(),d("tr",{key:e.id},[t("td",null,[t("div",{style:L([{height:"150px","background-size":"cover","background-position":"center"},{backgroundImage:`url(${e.product.imageUrl})`}])},null,4)]),t("td",null,g(e.product.title),1),t("td",null,[t("div",P,[e.qty>1?(r(),d("button",{key:0,class:"btn btn-outline-primary shadow-none",type:"button",onClick:l=>{e.qty--,i.changeQty(e,e.qty)}},z,8,R)):(r(),d("button",{key:1,class:"btn btn-outline-danger shadow-none",type:"button",onClick:l=>i.delCart(e.id)},O,8,Q)),D(t("input",{type:"number",class:"form-control bg-transparent shadow-none text-center",readonly:"","onUpdate:modelValue":l=>e.qty=l},null,8,G),[[E,e.qty]]),t("button",{class:"btn btn-outline-primary shadow-none",type:"button",onClick:l=>{e.qty++,i.changeQty(e,e.qty)}},W,8,J)])]),t("td",X," $"+g(e.total),1)]))),128))]),t("tfoot",null,[t("tr",Y,[Z,t("td",I,g(o.carts.total)+"元",1)]),o.carts.final_total!==o.carts.total?(r(),d("tr",tt,[et,t("td",st,g(o.carts.final_total)+"元",1)])):y("",!0)])]),t("button",{class:"btn btn-outline-danger d-block ms-auto",type:"button",onClick:s[0]||(s[0]=(...e)=>i.delCarts&&i.delCarts(...e))},[o.carts===o.status.delCartLoading?(r(),d("span",ot)):y("",!0),T(" 刪除全品項")])])]),at,t("div",lt,[nt,n(w,{action:"#",onSubmit:i.onSubmit,ref:"form"},{default:C(({errors:e})=>[t("div",it,[rt,n(h,{id:"mail",type:"mail",name:"Email",class:_(["form-control",{"is-invalid":e.Email}]),placeholder:"請輸入信箱",rules:"email|required",modelValue:o.form.user.email,"onUpdate:modelValue":s[1]||(s[1]=l=>o.form.user.email=l)},null,8,["modelValue","class"]),n(b,{name:"Email",class:"invalid-feedback"})]),t("div",dt,[ct,n(h,{id:"name",type:"text",name:"Name",class:_(["form-control",{"is-invalid":e.Name}]),rules:"required",modelValue:o.form.user.name,"onUpdate:modelValue":s[2]||(s[2]=l=>o.form.user.name=l),placeholder:"請輸入姓名"},null,8,["modelValue","class"]),n(b,{name:"Name",class:"invalid-feedback"})]),t("div",ut,[ht,n(h,{id:"tel",type:"tel",name:"Telephone",class:_(["form-control",{"is-invalid":e.Telephone}]),rules:i.isPhone,modelValue:o.form.user.tel,"onUpdate:modelValue":s[3]||(s[3]=l=>o.form.user.tel=l),placeholder:"請輸入電話"},null,8,["rules","modelValue","class"]),n(b,{name:"Telephone",class:"invalid-feedback"})]),t("div",mt,[_t,n(h,{id:"address",name:"Area",class:_(["form-control",{"is-invalid":e.Area}]),placeholder:"請輸入地區",rules:"required",modelValue:o.form.user.address,"onUpdate:modelValue":s[4]||(s[4]=l=>o.form.user.address=l),as:"select"},{default:C(()=>[pt,ft,bt,gt,vt,yt]),_:2},1032,["class","modelValue"]),n(b,{name:"Area",class:"invalid-feedback"})]),t("div",Ct,[wt,n(h,{id:"message",rows:"10",name:"Message",class:_(["form-control",{"is-invalid":e.Message}]),modelValue:o.form.user.message,"onUpdate:modelValue":s[5]||(s[5]=l=>o.form.user.message=l),as:"textarea"},null,8,["modelValue","class"])]),t("div",Vt,[t("div",kt,[t("button",{class:"btn btn-outline-secondary w-25",type:"button",onClick:s[6]||(s[6]=(...l)=>i.resetData&&i.resetData(...l))},"取消"),xt])])]),_:1},8,["onSubmit"])])])])])}const Et=V(U,[["render",Tt]]);export{Et as default};
